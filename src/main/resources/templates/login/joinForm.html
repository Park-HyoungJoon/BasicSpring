<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>e_do</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="canonical" href="https://getbootstrap.com/docs/5.1/examples/modals/">

    <!-- Bootstrap core CSS -->
<link href="/docs/5.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <!-- Favicons -->

</head>
<body>
<form>
&nbsp
</form>
<style type="text/css">
#floatingInput {   
    display: inline-block; 
 }
.btt { 
  position: absolute;
  right: 17px;
  top:16px;
  padding : 10px;
  width: 30px;
  border-radius: 5px;
  background-color: #FFFFFF; border-color: #94EBA7; color: #94EBA7; 
  width: 50px; padding: 3px; border: solid 1px;  font-size: 9pt;
 }
 .btt:active {
	margin-left: 2px;
	margin-top: 2px;
	box-shadow: 2px 2px 2px #94EBA7;
}
</style>
<div class="loca">
  <div class="modal-dialog" role="document">
    <div class="modal-content rounded-5 shadow">
      <div class="modal-header p-5 pb-4 border-bottom-0">
        <!-- <h5 class="modal-title">Modal title</h5> -->
        <h2 class="fw-bold mb-0">회원가입</h2>
      </div>

      <div class="modal-body p-5 pt-0">
        <form th:action="@{/join}" method="post" onsubmit="return btnSubmit();">
          <div class="form-floating mb-3">
          	
            <input type="email" class="form-control rounded-4" id="email" placeholder="name@example.com" name="email">
            <!-- <input type="button" value="Check" class="btt" id="btt">-->
            
            <label for="floatingInput">Email</label>
            <div id="mes" style="margin: 8px 0 -5px 5px; display: none; color: #FA4F5A; display: none">이미 존재하는 이메일 입니다.</div>
          </div>
          <div class="form-floating mb-3">
            <input type="text" class="form-control rounded-4" id="nick" placeholder="ppp" name="Nick">
            <label for="floatingPassword">name</label>
          </div>
          
          <div class="form-floating mb-3">
            <input type="password" class="form-control rounded-4" id="pw1" placeholder="Password" name="PW">
            <label for="floatingPassword">Password</label>
          </div>
          
          <div class="form-floating mb-3">
            <input type="password" class="form-control rounded-4" id="pw2" placeholder="Password">
            <label for="floatingPassword">Password check</label>
            <div id="mes2" style="margin: 8px 0 -5px 5px; display: flex; color: #FA4F5A; display: none">비밀번호가 일치하지 않습니다.</div>
          </div> 
          
          <button class="w-100 mb-2 btn btn-lg rounded-4 btn-primary" type="submit" 
          	style="background-color: #FFFFFF; border-color: #94EBA7; color: #94EBA7; ">Sign up</button>
        </form>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
const btn = document.getElementById("btt")
btn.addEventListener("click", e => {
	
})
</script>
<script type="text/javascript">
var emailconfirm = document.getElementById("email");
var mes = document.getElementById("mes");
//mes.style.display = 'flex';
emailconfirm.addEventListener('keyup',function(){
	var xhr = new XMLHttpRequest();
	var value='email=' + emailconfirm.value;

	xhr.open('POST', '/emailconfirim',true);
	xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
	xhr.send(value); /// ajax data부분
	xhr.onload = function() {
		if(xhr.status==200) {
			//alert(xhr.response);
			if(xhr.response == 'false') {
				mes.style.display = 'none';
			} else {
				mes.style.display = 'flex';
			}
		}
	}
})

var pw1 = document.getElementById("pw1");
var pw2 = document.getElementById("pw2");
pw2.addEventListener('keyup',function(){
	//alert(pw2.value);
	if(pw1.value == pw2.value) {
		mes2.style.display = 'none';
	} else {
		mes2.style.display = 'flex';
	}
})

pw1.addEventListener('keyup',function(){
	//alert(pw2.value);
	if(pw1.value == pw2.value) {
		mes2.style.display = 'none';
	} else {
		mes2.style.display = 'flex';
	}
})

function btnSubmit() {
  var p1 = document.getElementById( 'email' ).value;
  var p2 = document.getElementById( 'nick' ).value;
  var p3 = document.getElementById( 'pw1' ).value;
  var p4 = document.getElementById( 'pw2' ).value;
  
  if (p1 == "" || p2 == "" || p3 == "" || p4 =='') {
    alert( '빈칸 없이 입력해 주세요!' );
    return false;
  }
  
  var mes1 = document.getElementById("mes");
  var mes2 = document.getElementById("mes2");
  //alert(mes.style.display)
 
  if(mes.style.display == 'flex' || mes2.style.display == 'flex') {
	  alert( '입력한 내용을 확인해 주세요!' );
	  return false;
  }
}
</script>
</body>
</html>
